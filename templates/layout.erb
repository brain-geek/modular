<%% @layout_id = '<%=@layout_id%>'.to_sym %>

<% layout = Modular.layout(@layout_id) %>

<% if layout.is_a? Modular::Components::IndirectRender %>
  <%= layout.indirect_render %>
<% else %>
  <%%= Modular.layout('<%=@layout_id%>').render %>
<% end %>

<%% 
    layout = '<%=@original_layout%>'
    @_content_for[:layout] = self.output_buffer
    self.output_buffer = render(:file => "layouts/#{layout}")
 %>